<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>진상력 결과</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f6f7f9;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .result-container {
      background: white;
      padding: 40px;
      border-radius: 24px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      max-width: 600px;
      width: 90%;
      text-align: center;
    }

    h1 {
      font-size: 26px;
      margin-bottom: 20px;
      color: #333;
    }

    .score-section {
      margin-top: 30px;
    }

    .score-box {
      background: #f0f2f5;
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 12px;
      font-size: 18px;
      color: #444;
    }
  </style>
</head>
<body>
  <div class="result-container">
    <h1>진상력 테스트 결과</h1>
    <div id="resultText">채점 중입니다...</div>
    <div class="score-section" id="typeScores"></div>
  </div>

  <script>
    // 문항 번호 → 유형 매핑
    const typeMap = {
      "권리과잉형": [2, 3, 5],
      "과민반응형": [6, 10, 15],
      "오지랖형": [8, 11, 13],
      "자기중심형": [4, 7, 14],
      "피해망상형": [1, 9, 12]
    };

    // 로컬스토리지에서 answers 가져오기
    const answers = JSON.parse(localStorage.getItem("answers")) || [];

    const maxPerItem = 6;
    const maxTotal = maxPerItem * 3; // 유형당 문항 수: 3

    const scores = {};
    let totalScore = 0;

    for (const type in typeMap) {
      const qNums = typeMap[type];
      const sum = qNums.reduce((acc, qIdx) => acc + (answers[qIdx - 1] || 0), 0);
      scores[type] = Math.round((sum / maxTotal) * 100); // 100점 환산
      totalScore += sum;
    }

    // 진상력 총점 스펙트럼 계산
    const maxOverall = maxTotal * 5;
    const totalPercent = Math.round((totalScore / maxOverall) * 100);

    let spectrum = "";
    if (totalPercent <= 20) spectrum = "💡 일반인";
    else if (totalPercent <= 40) spectrum = "😐 가벼운 진상";
    else if (totalPercent <= 60) spectrum = "⚠️ 잠재 진상";
    else if (totalPercent <= 80) spectrum = "🔥 실전 진상";
    else spectrum = "👑 진상 만렙";

    // 결과 출력
    document.getElementById("resultText").innerHTML = `
      <p><strong>총 진상력 점수:</strong> ${totalScore}점 / ${maxOverall}점</p>
      <p><strong>스펙트럼 구간:</strong> ${spectrum}</p>
    `;

    const scoresBox = document.getElementById("typeScores");
    for (const type in scores) {
      const div = document.createElement("div");
      div.className = "score-box";
      div.innerText = `${type} 점수: ${scores[type]}점`;
      scoresBox.appendChild(div);
    }
  </script>
</body>
</html>
